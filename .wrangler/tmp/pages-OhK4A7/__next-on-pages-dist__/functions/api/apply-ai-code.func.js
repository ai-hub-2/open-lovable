var Me=Object.defineProperty;var Ue=Object.getOwnPropertyDescriptor;var qe=Object.getOwnPropertyNames;var Be=Object.prototype.hasOwnProperty;var $e=(l,r)=>()=>(l&&(r=l(l=0)),r);var Oe=(l,r,_e,v)=>{if(r&&typeof r=="object"||typeof r=="function")for(let w of qe(r))!Be.call(l,w)&&w!==_e&&Me(l,w,{get:()=>r[w],enumerable:!(v=Ue(r,w))||v.enumerable});return l},Ae=(l,r,_e)=>(Oe(l,r,"default"),_e&&Oe(_e,r,"default"));var He=l=>Oe(Me({},"__esModule",{value:!0}),l);var de={};import*as _a from"async_hooks";var Ne=$e(()=>{Ae(de,_a)});import{__getNamedExports as ze}from"../../../__next-on-pages-dist__/webpack/71ff79c606208bcc79e439670b104d2a.js";import{__getNamedExports as We}from"../../../__next-on-pages-dist__/manifest/88a389dd6c068190adb2efc795e4063c.js";var K=globalThis.__nextOnPagesRoutesIsolation.getProxyFor("/api/apply-ai-code"),e=ze(K,K,K),Ve=e.__chunk_9127,Ge=e.__chunk_5521,Ke=e.__chunk_5356,Xe=e.__chunk_975,Je=e.__chunk_9756,Qe=e.__chunk_9614,Ye=e.__chunk_9542,Ze=e.__chunk_9441,et=e.__chunk_9412,tt=e.__chunk_9249,nt=e.__chunk_9146,at=e.__chunk_8952,ct=e.__chunk_8948,st=e.__chunk_8903,ot=e.__chunk_8877,rt=e.__chunk_8818,_t=e.__chunk_8807,it=e.__chunk_8733,lt=e.__chunk_8637,ut=e.__chunk_8561,pt=e.__chunk_8538,dt=e.__chunk_8468,ht=e.__chunk_8455,mt=e.__chunk_8312,kt=e.__chunk_8311,ft=e.__chunk_8289,gt=e.__chunk_8246,yt=e.__chunk_8183,xt=e.__chunk_8146,vt=e.__chunk_8105,wt=e.__chunk_8051,bt=e.__chunk_7992,Rt=e.__chunk_7762,Et=e.__chunk_7724,St=e.__chunk_7671,Ct=e.__chunk_7329,It=e.__chunk_7254,Ot=e.__chunk_7149,At=e.__chunk_7078,jt=e.__chunk_7066,Pt=e.__chunk_6941,Mt=e.__chunk_6899,Nt=e.__chunk_6825,Tt=e.__chunk_6753,Ft=e.__chunk_6597,Dt=e.__chunk_6487,Lt=e.__chunk_6466,Ut=e.__chunk_6463,qt=e.__chunk_6399,Bt=e.__chunk_6276,$t=e.__chunk_6244,Ht=e.__chunk_6233,zt=e.__chunk_6161,Wt=e.__chunk_5988,Vt=e.__chunk_5951,Gt=e.__chunk_5931,Kt=e.__chunk_5813,Xt=e.__chunk_5807,Jt=e.__chunk_5759,Qt=e.__chunk_5697,Yt=e.__chunk_5687,Zt=e.__chunk_5626,en=e.__chunk_5582,tn=e.__chunk_5467,nn=e.__chunk_5431,an=e.__chunk_5295,cn=e.__chunk_5275,sn=e.__chunk_5214,on=e.__chunk_5205,rn=e.__chunk_5156,_n=e.__chunk_5123,ln=e.__chunk_5115,un=e.__chunk_5108,pn=e.__chunk_4962,dn=e.__chunk_4838,hn=e.__chunk_4799,mn=e.__chunk_4604,kn=e.__chunk_4600,fn=e.__chunk_4452,gn=e.__chunk_4442,yn=e.__chunk_4171,xn=e.__chunk_4084,vn=e.__chunk_3560,wn=e.__chunk_3481,bn=e.__chunk_3464,Rn=e.__chunk_3389,En=e.__chunk_3282,Sn=e.__chunk_2978,Cn=e.__chunk_2975,In=e.__chunk_2724,On=e.__chunk_2555,An=e.__chunk_2500,jn=e.__chunk_2452,Pn=e.__chunk_2354,Mn=e.__chunk_2338,Nn=e.__chunk_2231,Tn=e.__chunk_2052,Fn=e.__chunk_2009,Dn=e.__chunk_1755,Ln=e.__chunk_1728,Un=e.__chunk_1669,qn=e.__chunk_1450,Bn=e.__chunk_1415,$n=e.__chunk_1357,Hn=e.__chunk_1350,zn=e.__chunk_1114,Wn=e.__chunk_1012,Vn=e.__chunk_981,Gn=e.__chunk_816,Kn=e.__chunk_773,Xn=e.__chunk_555,Jn=e.__chunk_482,Qn=e.__chunk_471,Yn=e.__chunk_315,Zn=e.__chunk_311,ea=e.__chunk_305,ta=e.__chunk_297,na=e.__chunk_143,aa=e.__chunk_137,je=We(K,K,K),ca=je.__NEXT_FONT_MANIFEST,sa=je.__REACT_LOADABLE_MANIFEST,oa=je.__RSC_SERVER_MANIFEST,ua=((l,r,_e)=>(r._ENTRIES={},l.__RSC_SERVER_MANIFEST=oa,r.__RSC_MANIFEST=r.__RSC_MANIFEST||{},r.__RSC_MANIFEST["/api/apply-ai-code/route"]={moduleLoading:{prefix:"/_next/"},ssrModuleMapping:{239:{"*":{id:"9715",name:"*",chunks:[],async:!1}},563:{"*":{id:"3443",name:"*",chunks:[],async:!1}},649:{"*":{id:"2935",name:"*",chunks:[],async:!1}},1183:{"*":{id:"7267",name:"*",chunks:[],async:!1}},4142:{"*":{id:"9226",name:"*",chunks:[],async:!1}},4969:{"*":{id:"9915",name:"*",chunks:[],async:!1}},6671:{"*":{id:"2533",name:"*",chunks:[],async:!1}},6986:{"*":{id:"6212",name:"*",chunks:[],async:!1}},7393:{"*":{id:"5851",name:"*",chunks:[],async:!1}},9615:{"*":{id:"6763",name:"*",chunks:[],async:!1}}},edgeSSRModuleMapping:{},clientModules:{"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/client/components/builtin/global-error.js":{id:4969,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/esm/client/components/builtin/global-error.js":{id:4969,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/client/components/client-page.js":{id:4142,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/esm/client/components/client-page.js":{id:4142,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/client/components/client-segment.js":{id:6986,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/esm/client/components/client-segment.js":{id:6986,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/client/components/http-access-fallback/error-boundary.js":{id:239,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/esm/client/components/http-access-fallback/error-boundary.js":{id:239,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/client/components/layout-router.js":{id:563,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/esm/client/components/layout-router.js":{id:563,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/client/components/metadata/async-metadata.js":{id:9615,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/esm/client/components/metadata/async-metadata.js":{id:9615,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/client/components/metadata/metadata-boundary.js":{id:7393,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/esm/client/components/metadata/metadata-boundary.js":{id:7393,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/client/components/render-from-template-context.js":{id:6671,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/esm/client/components/render-from-template-context.js":{id:6671,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/lib/metadata/generate/icon-mark.js":{id:1183,name:"*",chunks:[],async:!1},"/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/dist/esm/lib/metadata/generate/icon-mark.js":{id:1183,name:"*",chunks:[],async:!1},'/workspace/node_modules/.pnpm/next@15.4.3_@opentelemetry+api@1.9.0_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/font/google/target.css?{"path":"app/layout.tsx","import":"Inter","arguments":[{"subsets":["latin"]}],"variableName":"inter"}':{id:171,name:"*",chunks:["177","static/chunks/app/layout-3782b268ecdeb8d5.js"],async:!1},"/workspace/app/globals.css":{id:5644,name:"*",chunks:["177","static/chunks/app/layout-3782b268ecdeb8d5.js"],async:!1},"/workspace/app/page.tsx":{id:649,name:"*",chunks:["974","static/chunks/app/page-669b50c51373d102.js"],async:!1}},entryCSSFiles:{"/workspace/":[],"/workspace/app/layout":[{inlined:!1,path:"static/css/bf21f89961c515c5.css"}],"/workspace/app/page":[],"/workspace/app/api/apply-ai-code/route":[]},rscModuleMapping:{239:{"*":{id:"8037",name:"*",chunks:[],async:!1}},563:{"*":{id:"9313",name:"*",chunks:[],async:!1}},649:{"*":{id:"9901",name:"*",chunks:[],async:!1}},1183:{"*":{id:"2849",name:"*",chunks:[],async:!1}},4142:{"*":{id:"604",name:"*",chunks:[],async:!1}},4969:{"*":{id:"6613",name:"*",chunks:[],async:!1}},5644:{"*":{id:"6272",name:"*",chunks:[],async:!1}},6671:{"*":{id:"1355",name:"*",chunks:[],async:!1}},6986:{"*":{id:"7130",name:"*",chunks:[],async:!1}},7393:{"*":{id:"4785",name:"*",chunks:[],async:!1}},9615:{"*":{id:"2857",name:"*",chunks:[],async:!1}}},edgeRscModuleMapping:{}},r.__BUILD_MANIFEST={polyfillFiles:["static/chunks/polyfills-42372ed130431b0a.js"],devFiles:[],ampDevFiles:[],lowPriorityFiles:[],rootMainFiles:["static/chunks/webpack-c81e624915b2ea70.js","static/chunks/e8d355e3-9914e85471131ade.js","static/chunks/524-3b39176777d9e519.js","static/chunks/main-app-0022c77dafc7be16.js"],rootMainFilesTree:{},pages:{"/_app":["static/chunks/webpack-c81e624915b2ea70.js","static/chunks/framework-dbaf03ed0eaf1259.js","static/chunks/main-789822056cd1f79e.js","static/chunks/pages/_app-fe624f995ae23665.js"],"/_error":["static/chunks/webpack-c81e624915b2ea70.js","static/chunks/framework-dbaf03ed0eaf1259.js","static/chunks/main-789822056cd1f79e.js","static/chunks/pages/_error-ad68bc602291205c.js"]},ampFirstPages:[]},r.__BUILD_MANIFEST.lowPriorityFiles=["/static/DTeZGmGGn6W-QfwdbqtUt/_buildManifest.js",,"/static/DTeZGmGGn6W-QfwdbqtUt/_ssgManifest.js"],l.__REACT_LOADABLE_MANIFEST=sa,l.__NEXT_FONT_MANIFEST=ca,l.__INTERCEPTION_ROUTE_REWRITE_MANIFEST="[]",(()=>{"use strict";var v={},w={};function n(c){var u=w[c];if(u!==void 0)return u.exports;var o=w[c]={id:c,loaded:!1,exports:{}},b=!0;try{v[c].call(o.exports,o,o.exports,n),b=!1}finally{b&&delete w[c]}return o.loaded=!0,o.exports}n.m=v,n.amdO={},(()=>{var c=[];n.O=(u,o,b,x)=>{if(o){x=x||0;for(var h=c.length;h>0&&c[h-1][2]>x;h--)c[h]=c[h-1];c[h]=[o,b,x];return}for(var C=1/0,h=0;h<c.length;h++){for(var[o,b,x]=c[h],I=!0,O=0;O<o.length;O++)(!1&x||C>=x)&&Object.keys(n.O).every(Y=>n.O[Y](o[O]))?o.splice(O--,1):(I=!1,x<C&&(C=x));if(I){c.splice(h--,1);var A=b();A!==void 0&&(u=A)}}return u}})(),n.n=c=>{var u=c&&c.__esModule?()=>c.default:()=>c;return n.d(u,{a:u}),u},n.d=(c,u)=>{for(var o in u)n.o(u,o)&&!n.o(c,o)&&Object.defineProperty(c,o,{enumerable:!0,get:u[o]})},n.e=()=>Promise.resolve(),n.g=function(){if(typeof r=="object")return r;try{return this||Function("return this")()}catch{if(typeof window=="object")return window}}(),n.o=(c,u)=>Object.prototype.hasOwnProperty.call(c,u),n.r=c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},n.nmd=c=>(c.paths=[],c.children||(c.children=[]),c),(()=>{var c={149:0};n.O.j=b=>c[b]===0;var u=(b,x)=>{var h,C,[I,O,A]=x,X=0;if(I.some(ce=>c[ce]!==0)){for(h in O)n.o(O,h)&&(n.m[h]=O[h]);if(A)var ie=A(n)}for(b&&b(x);X<I.length;X++)C=I[X],n.o(c,C)&&c[C]&&c[C][0](),c[C]=0;return n.O(ie)},o=l.webpackChunk_N_E=l.webpackChunk_N_E||[];o.forEach(u.bind(null,0)),o.push=u.bind(null,o.push.bind(o))})()})(),(l.webpackChunk_N_E=l.webpackChunk_N_E||[]).push([[499],{137:aa,143:na,297:ta,305:ea,311:Zn,315:Yn,471:Qn,482:Jn,555:Xn,773:Kn,816:Gn,981:Vn,1012:Wn,1114:zn,1350:Hn,1357:$n,1415:Bn,1450:qn,1669:Un,1728:Ln,1755:Dn,2009:Fn,2052:Tn,2231:Nn,2338:Mn,2354:Pn,2452:jn,2500:An,2555:On,2724:In,2975:Cn,2978:Sn,3282:En,3389:Rn,3464:bn,3481:wn,3560:vn,4084:xn,4171:yn,4442:gn,4452:fn,4600:kn,4604:mn,4799:hn,4838:dn,4962:pn,5108:un,5115:ln,5123:_n,5156:rn,5205:on,5214:sn,5275:cn,5295:an,5431:nn,5467:tn,5582:en,5626:Zt,5687:Yt,5697:Qt,5759:Jt,5807:Xt,5813:Kt,5931:Gt,5951:Vt,5988:Wt,6161:zt,6233:Ht,6244:$t,6276:Bt,6399:qt,6463:Ut,6466:Lt,6487:Dt,6597:Ft,6753:Tt,6825:Nt,6899:Mt,6941:Pt,7066:jt,7078:At,7149:Ot,7254:It,7329:Ct,7671:St,7724:Et,7762:Rt,7992:bt,8051:wt,8105:vt,8146:xt,8183:yt,8246:gt,8289:ft,8311:kt,8312:mt,8455:ht,8468:dt,8538:pt,8561:ut,8637:lt,8733:it,8807:_t,8818:rt,8877:ot,8903:st,8948:ct,8952:at,9146:nt,9249:tt,9412:et,9441:Ze,9542:Ye,9614:Qe,9756:Je}]),(l.webpackChunk_N_E=l.webpackChunk_N_E||[]).push([[745],{975:Xe,5356:Ke,5521:Ge,6115:(v,w,n)=>{"use strict";n.r(w),n.d(w,{ComponentMod:()=>ke,default:()=>Te});var c,u={};n.r(u),n.d(u,{POST:()=>t,runtime:()=>q});var o={};n.r(o),n.d(o,{handler:()=>W,patchFetch:()=>z,routeModule:()=>a,serverHooks:()=>R,workAsyncStorage:()=>s,workUnitAsyncStorage:()=>j});var b=n(981),x=n(1114),h=n(5626),C=n(5759),I=n(3464),O=n(6597),A=n(5951),X=n(3481),ie=n(2354),ce=n(8105),se=n(9412),Y=n(5687),he=n(2052),le=n(4962),me=n(8952),we=n(8538),oe=n(2975),be=n(816),H=n(6233),Z=n(6463);let q="edge";async function t(d){try{let{response:k,isEdit:V=!1,packages:fe=[]}=await d.json();if(!k)return Z.Rp.json({error:"response is required"},{status:400});let m=function(i){let p,g={files:[],commands:[],packages:[],structure:null,explanation:"",template:""},N=new Map,E=/<file path="([^"]+)">([\s\S]*?)(?:<\/file>|$)/g;for(;(p=E.exec(i))!==null;){let S=p[1],f=p[2].trim(),T=i.substring(p.index,p.index+p[0].length).includes("</file>"),L=N.get(S),y=!1;L?!L.isComplete&&T?(y=!0,console.log(`[parseAIResponse] Replacing incomplete ${S} with complete version`)):L.isComplete&&T&&f.length>L.content.length?(y=!0,console.log(`[parseAIResponse] Replacing ${S} with longer complete version`)):L.isComplete||T||!(f.length>L.content.length)||(y=!0):y=!0,y&&(!f.includes("...")||f.includes("...props")||f.includes("...rest")?N.set(S,{content:f,isComplete:T}):(console.warn(`[parseAIResponse] Warning: ${S} contains ellipsis, may be truncated`),L||N.set(S,{content:f,isComplete:T})))}for(let[S,{content:f,isComplete:T}]of N.entries())T||console.log(`[parseAIResponse] Warning: File ${S} appears to be truncated (no closing tag)`),g.files.push({path:S,content:f});let B=/<command>(.*?)<\/command>/g;for(;(p=B.exec(i))!==null;)g.commands.push(p[1].trim());let F=/<package>(.*?)<\/package>/g;for(;(p=F.exec(i))!==null;)g.packages.push(p[1].trim());let Q=i.match(/<packages>([\s\S]*?)<\/packages>/);if(Q){let S=Q[1].trim().split(/[\n,]+/).map(f=>f.trim()).filter(f=>f.length>0);g.packages.push(...S)}let D=i.match(/<structure>([\s\S]*?)<\/structure>/);D&&(g.structure=D[1].trim());let ee=i.match(/<explanation>([\s\S]*?)<\/explanation>/);ee&&(g.explanation=ee[1].trim());let pe=i.match(/<template>(.*?)<\/template>/);return pe&&(g.template=pe[1].trim()),g}(k);if(r.existingFiles||(r.existingFiles=new Set),!r.activeSandbox)return Z.Rp.json({success:!0,results:{filesCreated:m.files.map(i=>i.path),packagesInstalled:m.packages,commandsExecuted:m.commands,errors:[]},explanation:m.explanation,structure:m.structure,parsedFiles:m.files,message:`Parsed ${m.files.length} files successfully. Create a sandbox to apply them.`});console.log("[apply-ai-code] Applying code to sandbox..."),console.log("[apply-ai-code] Is edit mode:",V),console.log("[apply-ai-code] Files to write:",m.files.map(i=>i.path)),console.log("[apply-ai-code] Existing files:",Array.from(r.existingFiles));let J={filesCreated:[],filesUpdated:[],packagesInstalled:[],packagesAlreadyInstalled:[],packagesFailed:[],commandsExecuted:[],errors:[]},Re=[...fe.filter(i=>i&&typeof i=="string"),...m.packages],ue=[...new Set(Re)];if(ue.length>0){console.log("[apply-ai-code] Installing packages from XML tags and tool calls:",ue);try{let i=await fetch(`${process.env.NEXT_PUBLIC_APP_URL||"http://localhost:3000"}/api/install-packages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packages:ue})});if(i.ok){let p=await i.json();console.log("[apply-ai-code] Package installation result:",p),p.installed&&p.installed.length>0&&(J.packagesInstalled=p.installed),p.failed&&p.failed.length>0&&(J.packagesFailed=p.failed)}}catch(i){console.error("[apply-ai-code] Error installing packages:",i)}}else{console.log("[apply-ai-code] No packages provided, detecting from generated code..."),console.log("[apply-ai-code] Number of files to scan:",m.files.length);let i=["tailwind.config.js","vite.config.js","package.json","package-lock.json","tsconfig.json","postcss.config.js"],p=m.files.filter(E=>!i.includes(E.path.split("/").pop()||"")),g=/import\s+(?:(?:\{[^}]*\}|\*\s+as\s+\w+|\w+)\s*,?\s*)?(?:from\s+)?['"]([^'"]+)['"]/g,N=new Set;for(let E of p){let B;for(;(B=g.exec(E.content))!==null;){let F=B[1];if(!F.startsWith(".")&&!F.startsWith("/")){let Q=F.startsWith("@")?F.split("/").slice(0,2).join("/"):F.split("/")[0];N.add(Q)}}}if(N.size>0){console.log("[apply-ai-code] Detected packages from code:",Array.from(N));try{let E=await fetch(`${process.env.NEXT_PUBLIC_APP_URL||"http://localhost:3000"}/api/install-packages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({packages:Array.from(N)})}),B=await E.json();J.packagesInstalled=B.installed||[],J.packagesFailed=B.failed||[]}catch(E){console.error("[apply-ai-code] Failed to install detected packages:",E)}}}return Z.Rp.json({success:!0,results:J,explanation:m.explanation,structure:m.structure,parsedFiles:m.files})}catch(k){return console.error("[apply-ai-code] Error:",k),Z.Rp.json({success:!1,error:k.message},{status:500})}}var _=n(5356).Buffer;let a=new C.AppRouteRouteModule({definition:{kind:I.A.APP_ROUTE,page:"/api/apply-ai-code/route",pathname:"/api/apply-ai-code",filename:"route",bundlePath:"app/api/apply-ai-code/route"},distDir:process.env.__NEXT_RELATIVE_DIST_DIR||"",projectDir:process.env.__NEXT_RELATIVE_PROJECT_DIR||"",resolvedPagePath:"/workspace/app/api/apply-ai-code/route.ts",nextConfigOutput:"",userland:u}),{workAsyncStorage:s,workUnitAsyncStorage:j,serverHooks:R}=a;function z(){return(0,O.V5)({workAsyncStorage:s,workUnitAsyncStorage:j})}async function W(d,k,V){var fe;let m="/api/apply-ai-code/route";m==="/index"&&(m="/");let J=await a.prepare(d,k,{srcPage:m,multiZoneDraftMode:"false"});if(!J)return k.statusCode=400,k.end("Bad Request"),V.waitUntil==null||V.waitUntil.call(V,Promise.resolve()),null;let{buildId:Re,params:ue,nextConfig:i,isDraftMode:p,prerenderManifest:g,routerServerContext:N,isOnDemandRevalidate:E,revalidateOnlyGenerated:B,resolvedPathname:F}=J,Q=(0,ie.Y)(m),D=!!(g.dynamicRoutes[Q]||g.routes[F]);if(D&&!p){let $=!!g.routes[F],re=g.dynamicRoutes[Q];if(re&&re.fallback===!1&&!$)throw new be.G}let ee=null;!D||a.isDev||p||(ee=(ee=F)==="/index"?"/":ee);let pe=a.isDev===!0||!D,S=D&&!pe,f=d.method||"GET",T=(0,X.EK)(),L=T.getActiveScopeSpan(),y={params:ue,prerenderManifest:g,renderOpts:{experimental:{dynamicIO:!!i.experimental.dynamicIO,authInterrupts:!!i.experimental.authInterrupts},supportsDynamicResponse:pe,incrementalCache:(0,A.Ny)(d,"incrementalCache"),cacheLifeProfiles:(fe=i.experimental)==null?void 0:fe.cacheLife,isRevalidate:S,waitUntil:V.waitUntil,onClose:$=>{k.on("close",$)},onAfterTaskError:void 0,onInstrumentationRequestError:($,re,G)=>a.onRequestError(d,$,G,N)},sharedContext:{buildId:Re}},ge=new ce.j(d),Ee=new ce.p(k),Fe=se.u_.fromNodeNextRequest(ge,(0,se.SN)(k));try{let $=async G=>a.handle(Fe,y).finally(()=>{if(!G)return;G.setAttributes({"http.status_code":k.statusCode,"next.rsc":!1});let te=T.getRootSpanAttributes();if(!te)return;if(te.get("next.span_type")!==Y.Li.handleRequest)return void console.warn(`Unexpected root span type '${te.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let ne=te.get("next.route");if(ne){let ye=`${f} ${ne}`;G.setAttributes({"next.route":ne,"http.route":ne,"next.span_name":ye}),G.updateName(ye)}else G.updateName(`${f} ${d.url}`)}),re=async G=>{var te,ne;let ye=async({previousCacheEntry:Se})=>{try{if(!(0,A.Ny)(d,"minimalMode")&&E&&B&&!Se)return k.statusCode=404,k.setHeader("x-nextjs-cache","REVALIDATED"),k.end("This page could not be found"),null;let ae=await $(G);d.fetchMetrics=y.renderOpts.fetchMetrics;let Ce=y.renderOpts.pendingWaitUntil;Ce&&V.waitUntil&&(V.waitUntil(Ce),Ce=void 0);let Pe=y.renderOpts.collectedTags;if(!D)return await(0,le.I)(ge,Ee,ae,y.renderOpts.pendingWaitUntil),null;{let Ie=await ae.blob(),ve=(0,me.Cu)(ae.headers);Pe&&(ve[oe.VC]=Pe),!ve["content-type"]&&Ie.type&&(ve["content-type"]=Ie.type);let De=y.renderOpts.collectedRevalidate!==void 0&&!(y.renderOpts.collectedRevalidate>=oe.AR)&&y.renderOpts.collectedRevalidate,Le=y.renderOpts.collectedExpire===void 0||y.renderOpts.collectedExpire>=oe.AR?void 0:y.renderOpts.collectedExpire;return{value:{kind:H.yD.APP_ROUTE,status:ae.status,body:_.from(await Ie.arrayBuffer()),headers:ve},cacheControl:{revalidate:De,expire:Le}}}}catch(ae){throw Se?.isStale&&await a.onRequestError(d,ae,{routerKind:"App Router",routePath:m,routeType:"route",revalidateReason:(0,he.c)({isRevalidate:S,isOnDemandRevalidate:E})},N),ae}},U=await a.handleResponse({req:d,nextConfig:i,cacheKey:ee,routeKind:I.A.APP_ROUTE,isFallback:!1,prerenderManifest:g,isRoutePPREnabled:!1,isOnDemandRevalidate:E,revalidateOnlyGenerated:B,responseGenerator:ye,waitUntil:V.waitUntil});if(!D)return null;if((U==null||(te=U.value)==null?void 0:te.kind)!==H.yD.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${U==null||(ne=U.value)==null?void 0:ne.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,A.Ny)(d,"minimalMode")||k.setHeader("x-nextjs-cache",E?"REVALIDATED":U.isMiss?"MISS":U.isStale?"STALE":"HIT"),p&&k.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let xe=(0,me.p$)(U.value.headers);return(0,A.Ny)(d,"minimalMode")&&D||xe.delete(oe.VC),!U.cacheControl||k.getHeader("Cache-Control")||xe.get("Cache-Control")||xe.set("Cache-Control",(0,we.B)(U.cacheControl)),await(0,le.I)(ge,Ee,new Response(U.value.body,{headers:xe,status:U.value.status||200})),null};L?await re(L):await T.withPropagatedContext(d.headers,()=>T.trace(Y.Li.handleRequest,{spanName:`${f} ${d.url}`,kind:X.v8.SERVER,attributes:{"http.method":f,"http.target":d.url}},re))}catch($){if(L||await a.onRequestError(d,$,{routerKind:"App Router",routePath:Q,routeType:"route",revalidateReason:(0,he.c)({isRevalidate:S,isOnDemandRevalidate:E})}),D)throw $;return await(0,le.I)(ge,Ee,new Response(null,{status:500})),null}}let P=(c=l.__RSC_MANIFEST)==null?void 0:c["/api/apply-ai-code/route"],M=(d=>d?JSON.parse(d):void 0)(l.__RSC_SERVER_MANIFEST);P&&M&&(0,x.fQ)({page:"/api/apply-ai-code/route",clientReferenceManifest:P,serverActionsManifest:M,serverModuleMap:(0,b.e)({serverActionsManifest:M})});let ke=o,Te=h.s.wrap(a,{nextConfig:{env:{},webpack:null,eslint:{ignoreDuringBuilds:!0},typescript:{ignoreBuildErrors:!1,tsconfigPath:"tsconfig.json"},distDir:".next",cleanDistDir:!0,assetPrefix:"",cacheMaxMemorySize:52428800,configOrigin:"next.config.ts",useFileSystemPublicRoutes:!0,generateEtags:!0,pageExtensions:["tsx","ts","jsx","js"],poweredByHeader:!0,compress:!0,images:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:60,formats:["image/webp"],dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"attachment",remotePatterns:[],unoptimized:!1},devIndicators:{position:"bottom-left"},onDemandEntries:{maxInactiveAge:6e4,pagesBufferLength:5},amp:{canonicalBase:""},basePath:"",sassOptions:{},trailingSlash:!1,i18n:null,productionBrowserSourceMaps:!1,excludeDefaultMomentLocales:!0,serverRuntimeConfig:{},publicRuntimeConfig:{},reactProductionProfiling:!1,reactStrictMode:null,reactMaxHeadersLength:6e3,httpAgentOptions:{keepAlive:!0},logging:{},compiler:{},expireTime:31536e3,staticPageGenerationTimeout:60,modularizeImports:{"@mui/icons-material":{transform:"@mui/icons-material/{{member}}"},lodash:{transform:"lodash/{{member}}"}},outputFileTracingRoot:"/workspace",experimental:{useSkewCookie:!1,nodeMiddleware:!1,cacheLife:{default:{stale:300,revalidate:900,expire:4294967294},seconds:{stale:0,revalidate:1,expire:60},minutes:{stale:300,revalidate:60,expire:3600},hours:{stale:300,revalidate:3600,expire:86400},days:{stale:300,revalidate:86400,expire:604800},weeks:{stale:300,revalidate:604800,expire:2592e3},max:{stale:300,revalidate:2592e3,expire:4294967294}},cacheHandlers:{},cssChunking:!0,multiZoneDraftMode:!1,appNavFailHandling:!1,prerenderEarlyExit:!0,serverMinification:!0,serverSourceMaps:!1,linkNoTouchStart:!1,caseSensitiveRoutes:!1,clientSegmentCache:!1,dynamicOnHover:!1,preloadEntriesOnStart:!0,clientRouterFilter:!0,clientRouterFilterRedirects:!1,fetchCacheKeyPrefix:"",middlewarePrefetch:"flexible",optimisticClientCache:!0,manualClientBasePath:!1,cpus:3,memoryBasedWorkersCount:!1,imgOptConcurrency:null,imgOptTimeoutInSeconds:7,imgOptMaxInputPixels:268402689,imgOptSequentialRead:null,isrFlushToDisk:!0,workerThreads:!1,optimizeCss:!1,nextScriptWorkers:!1,scrollRestoration:!1,externalDir:!1,disableOptimizedLoading:!1,gzipSize:!0,craCompat:!1,esmExternals:!0,fullySpecified:!1,swcTraceProfiling:!1,forceSwcTransforms:!1,largePageDataBytes:128e3,typedRoutes:!1,typedEnv:!1,parallelServerCompiles:!1,parallelServerBuildTraces:!1,ppr:!1,authInterrupts:!1,webpackMemoryOptimizations:!1,optimizeServerReact:!0,viewTransition:!1,routerBFCache:!1,removeUncaughtErrorAndRejectionListeners:!1,validateRSCRequestHeaders:!1,staleTimes:{dynamic:0,static:300},serverComponentsHmrCache:!0,staticGenerationMaxConcurrency:8,staticGenerationMinPagesPerWorker:25,dynamicIO:!1,inlineCss:!1,useCache:!1,globalNotFound:!1,devtoolNewPanelUI:!1,devtoolSegmentExplorer:!1,browserDebugInfoInTerminal:!1,optimizeRouterScrolling:!1,strictNextHead:!0,trustHostHeader:!0,optimizePackageImports:["lucide-react","date-fns","lodash-es","ramda","antd","react-bootstrap","ahooks","@ant-design/icons","@headlessui/react","@headlessui-float/react","@heroicons/react/20/solid","@heroicons/react/24/solid","@heroicons/react/24/outline","@visx/visx","@tremor/react","rxjs","@mui/material","@mui/icons-material","recharts","react-use","effect","@effect/schema","@effect/platform","@effect/platform-node","@effect/platform-browser","@effect/platform-bun","@effect/sql","@effect/sql-mssql","@effect/sql-mysql2","@effect/sql-pg","@effect/sql-sqlite-node","@effect/sql-sqlite-bun","@effect/sql-sqlite-wasm","@effect/sql-sqlite-react-native","@effect/rpc","@effect/rpc-http","@effect/typeclass","@effect/experimental","@effect/opentelemetry","@material-ui/core","@material-ui/icons","@tabler/icons-react","mui-core","react-icons/ai","react-icons/bi","react-icons/bs","react-icons/cg","react-icons/ci","react-icons/di","react-icons/fa","react-icons/fa6","react-icons/fc","react-icons/fi","react-icons/gi","react-icons/go","react-icons/gr","react-icons/hi","react-icons/hi2","react-icons/im","react-icons/io","react-icons/io5","react-icons/lia","react-icons/lib","react-icons/lu","react-icons/md","react-icons/pi","react-icons/ri","react-icons/rx","react-icons/si","react-icons/sl","react-icons/tb","react-icons/tfi","react-icons/ti","react-icons/vsc","react-icons/wi"]},htmlLimitedBots:"Mediapartners-Google|Chrome-Lighthouse|Slurp|DuckDuckBot|baiduspider|yandex|sogou|bitlybot|tumblr|vkShare|quora link preview|redditbot|ia_archiver|Bingbot|BingPreview|applebot|facebookexternalhit|facebookcatalog|Twitterbot|LinkedInBot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|Yeti",bundlePagesRouterDependencies:!1,configFile:"/workspace/next.config.ts",configFileName:"next.config.ts",turbopack:{root:"/workspace"}}})},9127:Ve},v=>{v.O(0,[499],()=>v(v.s=6115));var w=v.O();(r._ENTRIES=typeof r._ENTRIES>"u"?{}:r._ENTRIES)["middleware_app/api/apply-ai-code/route"]=w}]),function(){let v={exports:{},loaded:!1};return function(n,c){var u=Object.create,o=Object.defineProperty,b=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,h=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty,I=t=>o(t,"__esModule",{value:!0}),O=(t,_)=>{I(t);for(var a in _)o(t,a,{get:_[a],enumerable:!0})},A=(t,_,a)=>{if(_&&typeof _=="object"||typeof _=="function")for(let s of x(_))!C.call(t,s)&&s!=="default"&&o(t,s,{get:()=>_[s],enumerable:!(a=b(_,s))||a.enumerable});return t},X=t=>A(I(o(t!=null?u(h(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);O(c,{default:()=>be});var ie=X((Ne(),He(de))),ce="@next/request-context",se=Symbol.for(ce),Y=Symbol.for("internal.storage");function he(){let t=r;if(!t[se]){let _=new ie.AsyncLocalStorage,a={get:()=>_.getStore(),[Y]:_};t[se]=a}return t[se]}var le=he();function me(t,_){return le[Y].run(t,_)}function we(t){let _={};return t&&t.forEach((a,s)=>{_[s]=a,s.toLowerCase()==="set-cookie"&&(_[s]=oe(a))}),_}function oe(t){let _=[],a=0,s,j,R,z,W;function P(){for(;a<t.length&&/\s/.test(t.charAt(a));)a+=1;return a<t.length}function M(){return j=t.charAt(a),j!=="="&&j!==";"&&j!==","}for(;a<t.length;){for(s=a,W=!1;P();)if(j=t.charAt(a),j===","){for(R=a,a+=1,P(),z=a;a<t.length&&M();)a+=1;a<t.length&&t.charAt(a)==="="?(W=!0,a=z,_.push(t.substring(s,R)),s=a):a=R+1}else a+=1;(!W||a>=t.length)&&_.push(t.substring(s,t.length))}return _}function be(t){let _=t.staticRoutes.map(s=>({regexp:new RegExp(s.namedRegex),page:s.page})),a=t.dynamicRoutes?.map(s=>({regexp:new RegExp(s.namedRegex),page:s.page}))||[];return async function(s,j){let R=new URL(s.url).pathname,z={};if(t.nextConfig?.basePath&&R.startsWith(t.nextConfig.basePath)&&(R=R.replace(t.nextConfig.basePath,"")||"/"),t.nextConfig?.i18n)for(let P of t.nextConfig.i18n.locales){let M=new RegExp(`^/${P}($|/)`,"i");if(R.match(M)){R=R.replace(M,"/")||"/";break}}for(let P of _)if(P.regexp.exec(R)){z.name=P.page;break}if(!z.name){let P=Z(R);for(let M of a||[]){if(P&&!Z(M.page))continue;let ke=M.regexp.exec(R);if(ke){z={name:M.page,params:ke.groups};break}}}let W=await me({waitUntil:j.waitUntil},()=>r._ENTRIES[`middleware_${t.name}`].default.call({},{request:{url:s.url,method:s.method,headers:we(s.headers),ip:H(s.headers,q.Ip),geo:{city:H(s.headers,q.City,!0),country:H(s.headers,q.Country,!0),latitude:H(s.headers,q.Latitude),longitude:H(s.headers,q.Longitude),region:H(s.headers,q.Region,!0)},nextConfig:t.nextConfig,page:z,body:s.body}}));return W.waitUntil&&j.waitUntil(W.waitUntil),W.response}}function H(t,_,a=!1){let s=t.get(_)||void 0;return a&&s?decodeURIComponent(s):s}function Z(t){return t==="/api"||t.startsWith("/api/")}var q;(function(t){t.City="x-vercel-ip-city",t.Country="x-vercel-ip-country",t.Ip="x-real-ip",t.Latitude="x-vercel-ip-latitude",t.Longitude="x-vercel-ip-longitude",t.Region="x-vercel-ip-country-region"})(q||(q={}))}(v,v.exports),v.exports}.call({}).default({name:"app/api/apply-ai-code/route",staticRoutes:[{page:"/",regex:"^/(?:/)?$",routeKeys:{},namedRegex:"^/(?:/)?$"},{page:"/_not-found",regex:"^/_not\\-found(?:/)?$",routeKeys:{},namedRegex:"^/_not\\-found(?:/)?$"},{page:"/favicon.ico",regex:"^/favicon\\.ico(?:/)?$",routeKeys:{},namedRegex:"^/favicon\\.ico(?:/)?$"}],dynamicRoutes:[],nextConfig:{basePath:""}})))(K,K,K);export{ua as default};
